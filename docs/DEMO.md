# 主动家居智能体演示文档

## 项目概述

这是一个基于Python(FastAPI)+Vue的主动家居智能体系统，能够：
- 🏠 模拟智能家居环境和设备状态
- 🤖 智能分析家居状态并主动提供建议
- 💬 支持用户交互和自动执行操作
- 📊 提供完整的API接口和状态监控

## 功能演示

### 1. 系统状态监控

```bash
curl http://localhost:8000/api/status
```

返回：
```json
{
    "status": "running",
    "devices_count": 7,
    "agent_active": true,
    "timestamp": "2025-07-15T04:04:31.972456"
}
```

### 2. 设备管理

#### 获取所有设备
```bash
curl http://localhost:8000/api/devices/
```

#### 按房间获取设备
```bash
curl http://localhost:8000/api/devices/room/bedroom
```

#### 切换设备状态
```bash
curl -X POST http://localhost:8000/api/devices/light_kitchen/toggle
```

#### 设备状态摘要
```bash
curl http://localhost:8000/api/devices/status/summary
```

### 3. 智能体功能

#### 创建演示场景
```bash
curl -X GET http://localhost:8000/api/agent/demo/scenario
```

这会创建一个典型场景：卧室有人5分钟，客厅无人但灯开着。智能体会分析并提供建议。

#### 用户交互
```bash
curl -X POST http://localhost:8000/api/agent/interact \
  -H "Content-Type: application/json" \
  -d '{"message": "是的，帮我关掉客厅的灯"}'
```

#### 获取对话历史
```bash
curl http://localhost:8000/api/agent/history
```

#### 手动触发分析
```bash
curl -X POST http://localhost:8000/api/agent/analyze
```

## 技术特色

### 1. 智能分析算法
- 检测房间无人但灯开着的浪费情况
- 识别用户长时间停留模式
- 基于规则和AI的混合推理

### 2. 模拟家居环境
- 实时模拟传感器数据变化
- 支持多种设备类型：灯光、传感器、空调
- 自动保存状态历史

### 3. 用户友好的交互
- 自然语言建议
- 支持用户确认和拒绝
- 记住用户偏好

### 4. 完整的API设计
- RESTful API设计
- 自动生成API文档
- 支持跨域访问

## 演示场景

### 场景1：节能提醒
1. **检测**: 客厅无人但灯开着
2. **建议**: "客厅没有人，但灯还开着，需要我帮你关吗？"
3. **执行**: 用户同意后自动关灯

### 场景2：舒适度调节
1. **检测**: 卧室有人且温度过高
2. **建议**: "卧室温度有点高，要不要开空调？"
3. **执行**: 自动调节空调设置

### 场景3：安全提醒
1. **检测**: 离家但有设备未关闭
2. **建议**: "你似乎要出门了，客厅的灯还开着，需要关掉吗？"
3. **执行**: 批量关闭不必要的设备

## 快速开始

1. **启动服务**：
   ```bash
   cd backend && python app.py
   ```

2. **查看API文档**：
   打开浏览器访问 http://localhost:8000/docs

3. **运行测试脚本**：
   ```bash
   ./test_api.sh
   ```

4. **体验完整流程**：
   - 访问演示场景API创建情景
   - 查看智能体建议
   - 进行用户交互
   - 观察设备状态变化

## 扩展功能

### 已实现
- ✅ 基础设备模拟和控制
- ✅ 智能状态分析
- ✅ 用户交互和对话历史
- ✅ 规则基础的建议生成
- ✅ 完整的API接口

### 可扩展
- 🔄 集成真实智能家居设备
- 🔄 接入GPT等大语言模型
- 🔄 添加更多设备类型
- 🔄 实现学习用户偏好
- 🔄 添加前端用户界面
- 🔄 支持语音交互
- 🔄 集成天气、日程等外部数据

## 技术亮点

1. **模块化设计**: 清晰的分层架构，易于扩展
2. **异步处理**: 后台模拟和实时响应并行
3. **数据持久化**: SQLite数据库保存状态和历史
4. **智能推理**: 多模式分析和建议生成
5. **用户体验**: 自然语言交互和智能操作

这个项目展示了如何构建一个实用的智能家居助手系统，具备实际应用的潜力和良好的扩展性。
